wx.prototype.ZH=$Q(57,function(){return pw(this,9)});Ax.prototype.ZH=$Q(56,function(){return pw(this,21)});uz.prototype.ZH=$Q(55,function(){return pw(this,10)});xg.prototype.sQ=$Q(12,function(){return F(this,56)});function s3d(a,b){var c=new KW,d;for(d in a.C)d in b.C||(c.C[d]=null);return c}var t3d=[5,10];function u3d(a){Of(this,a,0,-1,t3d,null)}x(u3d,Nf);u3d.prototype.getContext=function(){return F(this,1)};u3d.prototype.setContext=function(a){G(this,1,a)};u3d.prototype.Yu=function(){G(this,1,void 0)};
u3d.prototype.Eja=function(){return F(this,8)};function v3d(a){Of(this,a,0,-1,null,null)}x(v3d,Nf);
function w3d(a){return P("<div"+(a.id?' id="'+Q(a.id)+'"':"")+' class="'+(a.dg?Q(a.dg)+" ":"")+Q("goog-flat-menu-button")+" "+Q("goog-flat-menu-button-disabled")+" "+Q("goog-inline-block")+'" role="button"'+(a.Mm?' aria-label="'+Q(a.Mm)+'"':"")+'><div class="'+Q("goog-flat-menu-button-caption")+" "+Q("goog-inline-block")+'">'+O(a.pB)+'</div><div class="'+Q("goog-flat-menu-button-dropdown")+" "+Q("goog-inline-block")+'" aria-hidden="true">&nbsp;</div>'+(a.$k?O(a.$k):"")+"</div>")}
function x3d(a,b,c){b=c||b;a=a||{};return P(Gs(qr({pP:sr("docs-icon-close-small")},a),b))}function y3d(a,b){Rs.call(this);this.C=a;this.D[a]=b}x(y3d,Rs);y3d.prototype.Ol=function(a){var b={};b[this.C]=a;Ts(this,b)};function S5(){fs.call(this);this.C=new KW;gs(this,new ks(es,{},{wordList:[]}));this.J=new vm;this.qa(this.J)}x(S5,fs);ta(S5);S5.prototype.F=function(a){z3d(this,a,!0)};function z3d(a,b,c){var d=a.C.contains(b.toLowerCase()),e=b.toLowerCase();a.C.add(e);if(!d){var f={};f.value=e;hs(a).get("wordList").push(f);c&&A3d(a,[b],[])}return!d}S5.prototype.O=function(a){B3d(this,a,!0)};
function B3d(a,b,c){var d=a.C.contains(b.toLowerCase());if(d){var e=b.toLowerCase();a.C.remove(e);for(var f=hs(a).get("wordList"),h=0;h<f.length;h++)if(f[h].value===e){f.splice(h,1);break}c&&A3d(a,[],[b])}return d}S5.prototype.H=function(a){a=a.get("wordList");for(var b=0;b<a.length;b++)z3d(this,a[b].value,!1);a.length&&this.J.dispatchEvent(null)};function A3d(a,b,c){var d={};d.dictSAdd=b;d.dictSRemove=c;a.J.dispatchEvent(null);a.D.dispatchEvent(new js(new is("docs-user_dictionary",d),hs(a)))};function C3d(a,b,c){du.call(this,a,b,c);Cq(this,"Preferences")}x(C3d,du);p=C3d.prototype;p.Ga=function(){C3d.ea.Ga.call(this);this.getHandler().R(this,"dialogselect",this.b$a)};p.setVisible=function(a){C3d.ea.setVisible.call(this,a);a&&this.update()};p.update=sa;p.b$a=function(a){"ok"==a.key&&this.qTa()};p.qTa=sa;function D3d(a){var b='<span class="docs-userdictionary-butterbar-item">';a='<b>"'+(O(a.qU)+'"</b> added to your personal dictionary.');return P(b+a+"</span>")}function E3d(a){var b='<span class="docs-userdictionary-butterbar-item">';a='<b>"'+(O(a.qU)+'"</b> removed from your personal dictionary.');return P(b+a+"</span>")}
function F3d(a,b,c){b=c||b;a='<div class="docs-userdictionarydialog-content"><div class="docs-userdictionarydialog-top-container"><div><input class="docs-userdictionarydialog-input '+Q("jfk-textinput")+'" type="text" aria-label="'+Q(a.lNa)+'" placeholder="'+Q(a.lNa)+'"></div><div class="docs-userdictionarydialog-button-add-container">';a+=O(Cr({Ld:"docs-userdictionarydialog-button-add",style:0,content:tr("Add")},b));return P(a+'</div></div><div class="docs-userdictionarydialog-list-container"></div></div>')}
function G3d(a){return P('<div class="docs-userdictionarydialog-row-container" role="option"><div title="'+Q(a.qU)+'" class="docs-userdictionarydialog-row-content">'+O(a.qU)+"</div></div>")};function T5(a,b){kk.call(this,void 0,new H3d);this.hta=a;this.C=b}x(T5,kk);T5.prototype.Em=ba();T5.prototype.oC=function(a){a.relatedTarget&&pe(this.C,a.relatedTarget)||T5.ea.oC.call(this,a)};T5.prototype.Yh=function(a){return(46==a.keyCode||8==a.keyCode)&&this.ih(a)};function H3d(){}x(H3d,Di);H3d.prototype.hc=n("docs-userdictionarydialog-row-container");H3d.prototype.xa=function(a){return N(G3d,{qU:a.hta})};function U5(a){vk.call(this,void 0,new I3d);this.D=a;this.C=this.F=null}x(U5,vk);p=U5.prototype;p.Ga=function(){U5.ea.Ga.call(this);zh(this.Qa(),"Personal dictionary entries.  Press DELETE or BACKSPACE to remove words from the dictionary.");uh(this.Qa(),"listbox");var a=this.F;L(a,!1);si(a,!0);this.C=new fk(a);this.getHandler().R(this,"action",this.hpa).R(this.F,"click",this.hpa).R(this.C,"key",this.fob)};p.vd=function(){U5.ea.vd.call(this);C(this.C);this.C=null};
function J3d(a){var b=[];a.yf(function(a){b.push(a.hta)});return b}p.hpa=function(){var a=zk(this),b=this.Pq()==this.$c()-1;this.highlightPrevious();this.removeChild(a,!0);b||this.highlightNext();K3d(this);this.dispatchEvent("change")};p.fob=function(a){return 13==a.keyCode||32==a.keyCode?(this.hpa(a),a.preventDefault(),a.stopPropagation(),!0):!1};p.nx=function(){0==this.Ni("docs-userdictionarydialog-row-container-hover").length&&Ak(this)};p.jp=function(a){a.stopPropagation();a.preventDefault()};
p.Ij=function(a){return 27==a.keyCode?!1:U5.ea.Ij.call(this,a)};p.xY=function(a){U5.ea.xY.call(this,a);K3d(this)};p.Zja=function(a){var b=ye(document);U5.ea.Zja.call(this,a);b&&Bh(b,"docs-userdictionarydialog-list-remove-button")?this.Qa().focus():K3d(this)};function K3d(a){if(zk(a)){var b=zk(a),c=Math.round((mi(b.Qa()).height-mi(a.F).height)/2);a.F.style.top=$h(b.Qa()).y+c+"px";zh(a.F,"Remove "+b.hta);L(a.F,!0)}else L(a.F,!1)}function I3d(){this.C=void 0}x(I3d,jk);
I3d.prototype.zp=function(a){var b=N(x3d,{enabled:!0,dg:"docs-userdictionarydialog-list-remove-button"});a.F=b;a.getElement().appendChild(b)};function V5(a,b,c,d){C3d.call(this,b,c,d);this.ma=a;this.F=new Dr(null,d);this.Fa(this.F);this.L=this.C=null;this.J=new U5(a);this.Fa(this.J);this.O=null;Cq(this,"Personal dictionary");a=Rq((new Mq).set("ok","Save",!0),Uq,!1,!0);Pq(this,a)}x(V5,C3d);p=V5.prototype;p.xa=function(){V5.ea.xa.call(this);gr(this.Ib(),F3d,{lNa:"Add a new word"});ar(this,"ok");this.F.hb(this.Ia("docs-userdictionarydialog-button-add"));this.J.hb(this.Ia("docs-userdictionarydialog-list-container"));this.C=this.Ia("docs-userdictionarydialog-input")};
p.Ga=function(){V5.ea.Ga.call(this);this.F.Na(!1);this.L=new Cs(this.C);this.getHandler().R(this.F,"action",this.omb).R(this.C,"keypress",this.Kab).R(this.L,"input",this.Jab).R(this.J,"change",this.orb);this.getHandler().R(this.F.getElement(),"focus",this.Dha).R(this.C,"focus",this.Dha);for(var a=LCa(this.D),b=0;b<a.length;b++)this.getHandler().R(a[b],"focus",this.Dha);this.O=new xL(this.J)};p.vd=function(){V5.ea.vd.call(this);Bb(this.L,this.O);this.O=this.L=null};p.omb=function(){L3d(this)};
p.Jab=function(){this.F.Na(!Jb(Xb(this.C.value)))};p.Kab=function(a){13==a.keyCode&&(this.F.isEnabled()&&L3d(this),a.stopPropagation(),a.preventDefault())};p.Dha=function(){this.J.zg(-1)};p.orb=function(){Qq(this.D,"ok").disabled=!1};p.update=function(){var a=this.J;a.Fd(!0);var b=a.D.C.Dd();b.sort(rEc());for(var c=0;c<b.length;c++)a.Fa(new T5(b[c],a.F),!0);M3d(this,"");Qq(this.D,"ok").disabled=!0};
p.qTa=function(){var a=this.J;var b=new KW(a.D.C.Dd());var c=new KW(J3d(a));a=s3d(c,b).Dd();b=s3d(b,c).Dd();c=this.ma;for(var d=[],e=[],f=0;f<a.length;f++)z3d(c,a[f],!1)&&d.push(a[f]);for(f=0;f<b.length;f++)B3d(c,b[f],!1)&&e.push(b[f]);(0<d.length||0<e.length)&&A3d(c,d,e)};
p.setVisible=function(a){V5.ea.setVisible.call(this,a);if(a){var b=this.C;b&&(b.focus(),a=b.value.length,IGa(b)?(b.selectionStart=a,b.selectionEnd=a):Jc&&!Uc("9")&&(a=KGa(b,a),b=b.createTextRange(),b.collapse(!0),b.move("character",a),b.select()))}};function M3d(a,b,c){a.C.value=b;a.F.Na(!Jb(Xb(a.C.value)));c&&a.C.select()}
function L3d(a){var b=a.J,c=a.C.value;c=c.toLowerCase().trim();-1==J3d(b).indexOf(c)&&(c=new T5(c,b.F),b.oh(c,0,!0),b.Qa().scrollTop=0,b.dispatchEvent("change"));Ge(a.oa())==a.C&&a.C.blur();M3d(a,"");a.C.focus()};function N3d(a,b){var c=new V5(S5.getInstance());a.Mi(c);return Ba(O3d,c,b)}function O3d(a,b,c){a.setVisible(!0);b();c&&M3d(a,c,!0)};function P3d(){A.call(this);this.C=new Set;this.D=new vm;this.qa(this.D)}x(P3d,A);function Q3d(){}Q3d.prototype.get=Ke;function R3d(a,b){this.C=a;this.D=b}R3d.prototype.equals=function(a){return this.C.equals(a.C)&&this.D.equals(a.getSelection())};R3d.prototype.getSelection=g("D");function S3d(a,b){this.D=a;this.C=b};function T3d(a,b,c){this.C=a;this.F=b;this.D=c||null}T3d.prototype.xv=g("F");function U3d(a,b,c,d,e,f){A.call(this);this.F=a;this.L=b;this.C=c;this.D=d;this.H=e;this.J=f||null;this.Ja=new Jh(this);this.qa(this.Ja)}x(U3d,A);p=U3d.prototype;p.Iab=function(a){var b=this.C.C;V3d(this.D,a);W3d(this,b,!0)};
p.Bob=function(a){var b=this.C.C,c=this.D,d=Ub(a.C.xv()),e=a.D;a=new mE;W(a,1,"\\b"+d+"\\b");W(a,3,e);W(a,6,!1);W(a,7,!1);W(a,8,!0);a.setType(2);W(a,11,0);d=c.C.F;switch(c.C.V){case "RANGE":W(a,5,0);a.setSelection(dB(d.rect,d.ld));var f=AH(c.D,d.ld);break;case "SHEET":W(a,5,1);f=new Sw;W(f,1,""+d.ld);a.setSelection(f);f=AH(c.D,d.ld);break;case "WORKBOOK":W(a,5,2),f=c.D.h6(-1,0,!1)}f=f.Gc();c.F.C(new EW(f,a));W3d(this,b,!0)};
p.mvb=function(a){var b=this.C.C;if(na(a)){var c=this.L;c.C.has(a.toLowerCase())||(c.C.add(a.toLowerCase()),c.D.dispatchEvent(null))}W3d(this,b,!1)};p.hqb=function(a){var b=this.C.C;if(a instanceof R3d){var c=this.D.H,d=a.C.xv();a=a.getSelection();if(!X3d(c,d,a)){var e=c.C[""+a.C];e||(e=MF(c.F,a.C),e.getSheetType(),e=e.Gc(),e=new LH(e,!0),c.C[""+a.C]=e);c=a.Hd.y;a=a.Hd.x;var f=e.hf(c,a);f||(f=new Qm,hjb(e,c,a,f));f.add(d.toLowerCase())}}W3d(this,b,!1)};
p.$zb=function(a){var b=this.C.C;na(a)&&(this.J?this.J.F(a):S5.getInstance().F(a));W3d(this,b,!1)};p.eZ=function(){K.Qda.Nc(!1);this.Ja.Qc(this.F,"docs-text-spellcheckdialogcontroller-closed",this.eZ);Y3d(this.D.C)};p.bNb=function(){W3d(this,null,!1)};p.YKa=function(a){var b=this.F.C;L(b.Ba,!1);L(b.Ha,!0);b=this.C;var c=v(this.DWa,this,this.C.C,!1);this.H.C.getSelection();b.C&&(a?b.L.unshift(b.C):b.ma.push(b.C));Z3d(b,c,!!a)};
function W3d(a,b,c){var d=a.F.C;L(d.Ba,!1);L(d.Ha,!0);b=v(a.DWa,a,b,c);a.H.C.getSelection();Z3d(a.C,b,!1)}
p.DWa=function(a,b){a=this.F;a.C.setVisible(!0);var c=a.C;L(c.Ba,!0);L(c.Ha,!1);c=a.C;var d=c.J.C;Li(c.jb);var e=c.oa().yb("docs-slidingdialog-content",c.getElement());e&&vh(e,"label",d?"Spellcheck":"No spelling suggestions");if(d){e=d.C;var f=c.oa();c.getHandler().Qc(c.F,"focus",c.yLa).Qc(c.F,"blur",c.xLa).Qc(c.O,"input",c.ALa).Qc(c.F,"keydown",c.zLa);c.H.Pa("");var h=c.F,k=h.cloneNode(!0);je(k,h);c.F=f.getElement("docs-spellcheckslidingdialog-replacement-input");if(!c.F)throw Error("Replacement input not in DOM.");
C(c.removeChild(c.H));c.H=new KR("",f);c.Fa(c.H);c.H.hb(c.F);C(c.O);c.O=new Cs(c.F);for(c.getHandler().R(c.F,"focus",c.yLa).R(c.F,"blur",c.xLa).R(c.O,"input",c.ALa).R(c.F,"keydown",c.zLa);0<c.D.$c();)c.D.Ep(0).dispose();f="Next misspelling. Change "+(e.xv()+" to:");vh(c.F,"label",f);c.oa().Te(c.fd,e.xv());f=oc(e.C);if(0==f.length)c.H.Pa(e.xv()),e=new Ck("No suggestions"),c.D.Fa(e,!0),e.bf(2,!1),e.Na(!1),c.Yb.Ol(!1);else{c.H.Pa(f[0]);for(h=0;h<f.length;h++)e=new Ck(f[h]),c.D.Fa(e,!0),c.getHandler().R(e,
"action",c.kHb).R(e.getElement(),"dblclick",c.Bxb),1<f.length&&(e.lp(!0),Ch(Sd("goog-menuitem-checkbox",e.Qa()),"goog-inline-block"));(e=c.D.od(0))&&1<c.D.$c()&&e.xc(!0);c.D.zg(0);c.Yb.Ol(!0)}xEc(c.Ma,d.getSelection());c.pWa.call(c,c.ma);c.pWa.call(c,c.Ra);L(c.Wa,!1);L(c.Sa,!0)}else L(c.Sa,!1),ee(c.Rb),c.Hb&&c.Rb.appendChild(c.Hb),L(c.Wa,!0),c.jb=Ki(v(c.jr,c),c.Ac),c.Ma.Yu();a.C.focus();(a=this.C.C)?$3d(this.D,a.getSelection()):b&&$3d(this.D)};function a4d(a,b,c,d){if("bd"==a)return b-c;if("n"==a||!d)return b;if("si"==a)return b+1;if("sd"==a)return b-1;throw Error("Unsupported underline update type");};function b4d(a,b){this.C=a;this.D=b}var c4d=Fc(K.g2a.getId(),K.z0a.getId(),K.EN.getId(),K.UU.getId(),K.KU.getId()),d4d=Fc(K.pZa.getId(),K.WN.getId());function e4d(a,b,c,d,e,f,h){JW.call(this,h);this.L=a;this.J=b;this.xd=new b4d(e,f);this.Ma=new wEc(c);this.Fa(this.Ma);this.$=new Dr(null,h);this.Fa(this.$);this.ma=new Hk(h);this.ub=null;this.Kc=new Jr(null,this.ma,GO.getInstance());this.Fa(this.Kc);this.Oa=new Dr(null,h);this.Fa(this.Oa);this.Ra=new Hk(h);this.Cb=null;this.Uc=new Jr(null,this.Ra,GO.getInstance());this.Fa(this.Uc);this.xb=this.va=this.V=null;this.H=new KR("",h);this.Fa(this.H);this.D=new f4d(h);Ik(this.D,!1);this.Fa(this.D);this.Hb=
this.Rb=this.Wa=this.Sa=this.O=this.F=null;this.Ac=5E3;this.jb=this.fd=null;this.Yb=d;this.Ba=this.Ha=this.Ka=null}x(e4d,JW);function g4d(a){Dh(a.Qa(),["goog-menu-no-icon","goog-menu-noaccel"])}p=e4d.prototype;
p.Jha=function(){var a=sr("Spellcheck");var b='<div id="docs-spellcheckslidingdialog-loading"><div class="docs.spellcheckslidingdialog-loading-text">Loading spelling suggestions...'+('</div><div class="docs-spellcheckslidingdialog-loading-spinner">'+O(zEc())+'</div></div><div id="docs-spellcheckslidingdialog-content"><div id="docs-spellcheckslidingdialog-no-misspellings" tabindex="-1"><div class="docs-spellcheckslidingdialog-title-text docs-spellcheckslidingdialog-no-misspellings">');b=b+'No spelling suggestions</div><div id="docs-spellcheckslidingdialog-no-misspellings-footer"></div></div><div id="docs-spellcheckslidingdialog-misspellings"><div class="docs-spellcheckslidingdialog-title-text goog-inline-block">Change <span id="docs-spellcheckslidingdialog-original-word"></span> to:'+
('</div><div class="docs-spellcheckslidingdialog-container"><table cellspacing="0" role="presentation"><tbody><tr><td class="docs-spellcheckslidingdialog-replacement-input-container"><input id="docs-spellcheckslidingdialog-replacement-input" autocomplete="off" type="text" class="docs-spellcheckslidingdialog-replacement-input" spellcheck="false">'+O(yEc({id:"docs-spellcheckslidingdialog-replacement-context"}))+"</td><td>");b+=O(Cr({id:"docs-spellcheckslidingdialog-button-change",style:2,Ld:"docs-spellcheckslidingdialog-buttons-action",
content:tr("Change")},void 0));b+=O(w3d({id:"docs-spellcheckslidingdialog-button-change-menu",pB:""}))+'</td></tr><tr><td><div id="docs-spellcheckslidingdialog-suggestion-list"></div></td><td id="docs-spellcheckslidingdialog-ignore-buttons">';b+=O(Cr({id:"docs-spellcheckslidingdialog-button-ignore",style:0,Ld:"docs-spellcheckslidingdialog-buttons-action docs-spellcheckslidingdialog-buttons-white",content:tr("Ignore")},void 0));b+=O(w3d({id:"docs-spellcheckslidingdialog-button-ignore-menu",dg:"docs-spellcheckslidingdialog-buttons-white-menu",
pB:""}))+"<br/>";b+=O(Cr({id:"docs-spellcheckslidingdialog-button-dictionary",style:0,Ld:"docs-spellcheckslidingdialog-buttons-action docs-spellcheckslidingdialog-buttons-white",content:tr("Add to Dictionary")},void 0));b+=O(w3d({id:"docs-spellcheckslidingdialog-button-dictionary-menu",dg:"docs-spellcheckslidingdialog-buttons-white-menu",pB:""}))+"</td></tr></tbody></table></div></div></div>";b=P(b);a=""+O(AEc({iCa:a,Sk:tr(""+b)}));return P(a)};
p.a6=function(a){var b=this.xd,c=this.J.C,d=new xg,e=c?c.C.sQ():null,f=b.C.C.replace(/_/g,"-");J(I(),"docs-anddc")||J(I(),"docs-agdc");Jb(Xb(e))||G(d,56,e);G(d,60,f);if(c){e=c.C;var h,k;oc(e.C).length&&(h=oc(e.C)[0]);h&&(k=e.C[h]);h=new u3d;k&&(G(h,5,k.xVa||[]),k=k.Eja(),G(h,8,k),G(h,7,0));if(b=b.D.get(c)){a=c4d[a]?"bd":d4d[a]?"n":a==K.Y2a.getId()?"si":"sd";k=a4d(a,b.ZH.C,b.ZH.D,!0);e=Math.abs(k-b.ZH.C);G(h,6,k);G(h,9,e);k={};var l=[];c&&(l=nc(c.C.C));for(c=0;c<l.length;c++){var m=l[c];e=m.xVa;for(f=
0;f<e.length;f++){var r=e[f];pc(k,r)||(k[r]={});k[r][m.Eja()]=!0}}l=[];e=oc(b.C);for(c=0;c<e.length;c++){r=e[c];m=b.C[r];var u=oc(m);for(f=0;f<u.length;f++){var w=u[f],y=m[w],B=a4d(a,y.C,y.D,pc(k,r)&&pc(k[r],w));y=Math.abs(B-y.C);var H=new v3d;G(H,1,ec(r));G(H,2,ec(w));G(H,3,B);G(H,4,y);l.push(H)}}Wf(h,10,l)}Vf(d,66,h)}return Cj(Bj(new Aj,1),d).build()};
p.xa=function(){e4d.ea.xa.call(this);var a=Xd("SPAN","docs-spellcheckslidingdialog-menu-text","Change all"),b=Xd("SPAN","docs-spellcheckslidingdialog-count","");this.ub=new Ck([a,b]);this.ma.Fa(this.ub,!0);a=Xd("SPAN","docs-spellcheckslidingdialog-menu-text","Ignore all");b=Xd("SPAN","docs-spellcheckslidingdialog-count","");this.Cb=new Ck([a,b]);this.Ra.Fa(this.Cb,!0)};
p.Ga=function(){e4d.ea.Ga.call(this);Ch(this.Qa(),"docs-spellcheckslidingdialog");var a=this.oa();this.Ha=a.getElement("docs-spellcheckslidingdialog-loading");this.Ba=a.getElement("docs-spellcheckslidingdialog-content");this.Wa=a.getElement("docs-spellcheckslidingdialog-no-misspellings");this.Rb=a.getElement("docs-spellcheckslidingdialog-no-misspellings-footer");this.Sa=a.getElement("docs-spellcheckslidingdialog-misspellings");this.F=a.getElement("docs-spellcheckslidingdialog-replacement-input");
this.O=new Cs(this.F);this.fd=a.getElement("docs-spellcheckslidingdialog-original-word");this.Ma.hb(a.getElement("docs-spellcheckslidingdialog-replacement-context"));this.H.hb(this.F);this.$.hb(a.getElement("docs-spellcheckslidingdialog-button-change"));this.Oa.hb(a.getElement("docs-spellcheckslidingdialog-button-ignore"));h4d(this.Kc,this.$,"docs-spellcheckslidingdialog-button-change-menu",K.Tda,this.L,a);h4d(this.Uc,this.Oa,"docs-spellcheckslidingdialog-button-ignore-menu",K.Vda,this.L,a);this.D.hb(a.getElement("docs-spellcheckslidingdialog-suggestion-list"));
this.D.Dh(!0);g4d(this.D);lj(this.L,this.Oa,K.JU,nj,v(this.J.Ka,this.J),v(this.a6,this,K.JU.getId()));lj(this.L,this.$,K.FN,nj,v(this.Bjb,this),v(this.a6,this,K.FN.getId()));this.V=new Dr(null,this.oa());this.va=new Hk(a);this.xb=new Jr(null,this.va,GO.getInstance(),a);this.Fa(this.V);this.Fa(this.xb);this.V.hb(a.getElement("docs-spellcheckslidingdialog-button-dictionary"));i4d(this,this.V,K.UU,!0);h4d(this.xb,this.V,"docs-spellcheckslidingdialog-button-dictionary-menu",K.Uda,this.L,a);a=new Ck("View personal dictionary...");
var b=zc(nj);delete b["node-label"];delete b.label;lj(this.L,a,K.Ky,b,v(this.S5,this,this.J));this.va.Fa(a,!0);g4d(this.va);lj(this.L,this.ub,K.EN,void 0,v(this.z8a,this),v(this.a6,this,K.EN.getId()));g4d(this.ma);i4d(this,this.Cb,K.KU,!1);g4d(this.Ra);this.getHandler().R(this.D.getElement(),Jc?"focusin":"focus",this.KFb);this.Ka=new Yt(this.getElement());this.qa(this.Ka);a=eJa("Ctrl+single-quote",!1);b=eJa("Ctrl+semicolon",!1);hJa(this.Ka,K.Z2,[a]);hJa(this.Ka,K.a3,[b])};
p.focus=function(){pi(this.Sa)?OR(this.H):this.Wa.focus()};function h4d(a,b,c,d,e,f){c=f.getElement(c);a.hb(c);MT(a,1);$7b(a,b.getElement());MT(b,2);b=new Hj(c,a.He()?1:5);Z7b(a,b);lj(e,a,d,nj)}p.pWa=function(a){a=Sd("docs-spellcheckslidingdialog-count",a.getElement());this.oa().Te(a,"")};function j4d(a){var b=a.H.La();a=new T3d(b,a.S5(a.J),a.J);K.FN.Zb(a)}p.Bxb=function(){j4d(this)};p.yLa=function(){var a=this.oa().Tq(this.F);Ch(a,"docs-spellcheckslidingdialog-replacement-input-container-focus")};
p.xLa=function(){var a=this.oa().Tq(this.F);Eh(a,"docs-spellcheckslidingdialog-replacement-input-container-focus")};p.zLa=function(a){13==a.keyCode&&j4d(this)};p.KFb=function(){for(var a=0;a<this.D.$c();a++){var b=this.D.od(a);if(b.isChecked()){b.Rf(!0);return}}0<this.D.$c()&&this.D.zg(0)};function k4d(a){for(var b=0;b<a.D.$c();b++)a.D.od(b).xc(!1)}p.ALa=function(){k4d(this);this.Yb.Ol(!0)};p.kHb=function(a){var b=a.target.La();k4d(this);this.H.Pa(b);(a=a.target)&&1<this.D.$c()&&a.xc(!0);OR(this.H)};
p.Bjb=function(){var a=this.H.La();return new T3d(a,this.S5(this.J),this.J)};p.z8a=function(){var a=this.J;a=a.C?a.C.C:null;return new S3d(this.H.La(),a)};function i4d(a,b,c,d){lj(a.L,b,c,d?nj:void 0,v(a.S5,a,a.J),v(a.a6,a,c.getId()))}p.S5=function(a){return(a=a.C)?a.C.xv():null};p.Ea=function(){Li(this.jb);C(this.O);e4d.ea.Ea.call(this)};function f4d(a,b){Hk.call(this,a,b)}x(f4d,Hk);f4d.prototype.Ij=function(a){return 27==a.keyCode?!1:f4d.ea.Ij.call(this,a)};function l4d(){var a=S5.getInstance(),b=wp.getInstance();this.H=a;this.C=b;this.D=0}l4d.prototype.F=function(a){this.H.F(a);a=zp(N(D3d,{qU:a}),K.wn.getLabel(),v(this.O,this,a),"info",!0,1E4);xp(this.C,this.D);this.D=this.C.postMessage(a)};l4d.prototype.O=function(a){this.H.O(a);a=zp(N(E3d,{qU:a}),K.wn.getLabel(),v(this.F,this,a),"info",!0,1E4);xp(this.C,this.D);this.D=this.C.postMessage(a)};function m4d(a,b,c,d,e,f,h,k){E.call(this);this.J=a;this.H=b;this.L=c;this.D=e;this.ib=k||new Md;this.C=new e4d(this.H,this.D,this.L,d,f,h,this.ib);this.qa(this.C);this.Ja=new Jh(this);this.qa(this.Ja)}x(m4d,E);m4d.prototype.xD=function(a){var b=this.D.C;this.C.Qb()||this.C.render(ze(this.ib,"docs-spellcheckslidingdialog-id"));var c=this.C.PJ;c&&b?this.C.focus():(c||this.Ja.R(this.C,"close",this.F),a())};
m4d.prototype.F=function(){this.Ja.Qc(this.C,"close",this.F);this.dispatchEvent("docs-text-spellcheckdialogcontroller-closed");eEa(Kr.getInstance())||this.J.Lb(3);K.Pk.isEnabled()||wp.getInstance().postMessage(yp("Spellcheck will be unavailable until you reconnect.","info",!0,1E4))};function n4d(a){A.call(this);this.F=a;this.C={};this.D=new Jh(this);this.qa(this.D);this.D.R(a,"Na",this.H)}x(n4d,A);function X3d(a,b,c){if(a=a.C[""+c.C])if(c=a.hf(c.Hd.y,c.Hd.x))return!!c.contains(b.toLowerCase());return!1}n4d.prototype.H=function(a){C(this.C[""+a.bh]);delete this.C[""+a.bh]};function o4d(){this.xVa=[]}o4d.prototype.Eja=n(0);function p4d(a,b,c){this.D=a;this.F=c||null;this.C=b}p4d.prototype.xv=g("D");p4d.prototype.sQ=g("F");p4d.prototype.equals=function(a){var b=a.xv(),c=a.sQ();a=oc(a.C);return this.D==b&&this.F==c&&vb(oc(this.C),a)};function W5(){T.call(this)}x(W5,T);var q4d=null;W5.prototype.rangeCount=function(){return pw(this,2)};function X5(){T.call(this)}x(X5,T);var r4d=null;X5.prototype.$b=function(){return V(this,1)};function s4d(){T.call(this)}x(s4d,T);var t4d=null;function Y5(){T.call(this)}x(Y5,T);var u4d=null;Y5.prototype.jK=function(){return V(this,2)};function Z5(){T.call(this)}x(Z5,T);var v4d=null;Z5.prototype.xv=function(){return V(this,1)};Z5.prototype.sQ=function(){return V(this,5)};
W5.prototype.Ca=function(){var a=q4d;a||(q4d=a=vw(W5,{0:{name:"SpellcheckRequest",qb:"ritzproto.SpellcheckRequest"},1:{name:"start_searching_column",Aa:5,type:Number},2:{name:"range",Aa:11,type:Sw},3:{name:"search_all_sheets",Aa:8,type:Boolean},4:{name:"active_filter_views",zc:!0,Aa:11,type:X5}}));return a};W5.Ca=W5.prototype.Ca;
X5.prototype.Ca=function(){var a=r4d;a||(r4d=a=vw(X5,{0:{name:"FilterViewDataProto",qb:"ritzproto.FilterViewDataProto"},1:{name:"grid_id",Aa:9,type:String},2:{name:"filter_view_id",Aa:9,type:String}}));return a};X5.Ca=X5.prototype.Ca;
s4d.prototype.Ca=function(){var a=t4d;a||(t4d=a=vw(s4d,{0:{name:"SpellcheckResponse",qb:"ritzproto.SpellcheckResponse"},1:{name:"last_row_searched",Aa:5,type:Number},2:{name:"last_column_searched",Aa:5,type:Number},3:{name:"last_grid_id_searched",Aa:9,type:String},4:{name:"searched_all_sheets",Aa:8,type:Boolean},6:{name:"searched_whole_range",Aa:8,type:Boolean},5:{name:"cell_suggestions",zc:!0,Aa:11,type:Y5}}));return a};s4d.Ca=s4d.prototype.Ca;
Y5.prototype.Ca=function(){var a=u4d;a||(u4d=a=vw(Y5,{0:{name:"CellSuggestionsProto",qb:"ritzproto.CellSuggestionsProto"},1:{name:"phrase_suggestions",zc:!0,Aa:11,type:Z5},2:{name:"cell",Aa:11,type:sy}}));return a};Y5.Ca=Y5.prototype.Ca;
Z5.prototype.Ca=function(){var a=v4d;a||(v4d=a=vw(Z5,{0:{name:"PhraseSuggestionsProto",qb:"ritzproto.PhraseSuggestionsProto"},1:{name:"original_word",Aa:9,type:String},2:{name:"offset_start_index",Aa:5,type:Number},3:{name:"offset_end_index",Aa:5,type:Number},4:{name:"suggestions",zc:!0,Aa:9,type:String},5:{name:"spelling_language",Aa:9,type:String}}));return a};Z5.Ca=Z5.prototype.Ca;function w4d(a,b,c){this.Hd=a;this.C=b;this.Ye=c}w4d.prototype.equals=function(a){return this===a?!0:a instanceof w4d?Fd(a.Hd,this.Hd)&&a.C==this.C&&MOa(a.Ye,this.Ye):!1};function $5(a,b,c,d,e){A.call(this);this.H=a;this.Sa=b;this.Wa=c;this.Ra=d;this.Oa=e;this.D=this.J=this.C=null;this.O=!1;this.L=[];this.ma=[];this.va=new Jh(this);this.qa(this.va);this.$=null;this.V="RANGE";this.Ha=new xw;this.Ha.Ki=!0;this.Ba=new xw;this.Ba.Ki=!1}x($5,A);$5.prototype.Ka=g("C");function Y3d(a){VJ(a.$);a.va.Ic();a.V="RANGE";a.O=!1;a.L=[];a.ma=[]}
function x4d(a,b){var c=b.getSelection(),d=AH(a.H,c.C),e;(e=!d)||(d=d.Gc(),e=c.Hd,e=!(RH(BG(d,"r"),e.y)&&RH(BG(d,"c"),e.x)));if(e)return!1;c=c.Ye;a=y4d(a,b);b=b.C.xv();return a.substring(c.start,c.end)==b}function y4d(a,b){a=z4d(a,b);return Cb(a,"'")?a.substring(1):a}function A4d(a,b){a=z4d(a,b);return Cb(a,"'")}function z4d(a,b){b=b.getSelection();var c=b.Hd,d=b.C;a=AH(a.H,d).Gc();a.Pn(IA(b.Hd));return FH(a.eh(c.y,c.x),d,c.y,c.x)}
function B4d(a,b){if(a.D){var c=new W5,d=new Sw;W(d,1,a.D);W(d,2,a.J.y);switch(a.V){case "WORKBOOK":W(c,3,!0);d.Ar(0);var e=EI(a.H);for(var f=0;f<e.length;f++)0==e[f].getSheetType()&&C4d(c,e[f]);break;case "SHEET":d.Ar(0);e=AH(a.H,a.F.ld);C4d(c,e);break;case "RANGE":d.Ar(a.F.rect.kc()),Tw(d,a.F.rect.Vc()),d.Yx(a.F.rect.Wc()),e=AH(a.H,a.F.ld),C4d(c,e)}W(c,2,d);W(c,1,a.J.x+1);Wu(Ps(Qs(ku(a.Sa.Ue("/spell"),{data:a.Ha.serialize(c)}),"POST"),function(a){this.Xk(a,b)},a),function(){this.Xk(null,b)},a).xe()}else D4d(a,
b,!1)}function C4d(a,b){if(b){var c=b.Gc().H;if(yG(c)){b=""+b.Ab();c=MH(c);var d=new X5;W(d,1,b);W(d,2,c);qw(a,4,d)}}}
$5.prototype.Xk=function(a,b){if(a){a=this.Ba.zd(s4d.Ca(),a.kf());this.J=new Dd(V(a,2),V(a,1));this.D=V(a,3);this.O=V(a,6);a=tw(a,5);for(var c=0;c<a.length;c++){var d=a[c],e=d.jK().gs(),f=d.jK().getColumnIndex();e=new Dd(f,e);f=parseInt(d.jK().Ab(),10);d=tw(d,1);for(var h=0;h<d.length;h++){var k=d[h],l=k.xv(),m=V(k,2),r=V(k,3),u=k.sQ();m=new w4d(e,f,new wv(m,r));if(!E4d(this,l,m)){k=tw(k,4);r={};for(var w=0;w<k.length;w++)r[k[w]]=new o4d;this.L.push(new R3d(new p4d(l,r,u),m))}}}}Z3d(this,b,!1)};
function Z3d(a,b,c){if(c){var d=a.ma;var e=v(d.pop,d)}else d=a.L,e=v(d.shift,d);for(;0<d.length;){var f=e(),h=f.C.xv();if(!E4d(a,h,f.getSelection())){e=c;h=f.getSelection();c=AH(a.H,h.C);d=c.Gc();h=IA(h.Hd);f=v(a.Ma,a,f,b,e);d.Pn(h)?f():(VJ(a.$),a.$=AI(c.C,h).addCallback(f));return}}D4d(a,b,c)}function D4d(a,b,c){a.O||c?(a.C=null,b(null)):B4d(a,b)}$5.prototype.Ma=function(a,b,c){x4d(this,a)?(this.C=a,b(a.C)):Z3d(this,b,c)};
function E4d(a,b,c){return a.Ra.C.has(b.toLowerCase())||X3d(a.Oa,b,c)||a.Wa.C.contains(b.toLowerCase())}$5.prototype.Ea=function(){$5.ea.Ea.call(this);VJ(this.$)};function F4d(a,b,c,d){this.D=a;this.F=b;this.C=c;this.H=d}
function V3d(a,b){var c=b.D.C;if(x4d(a.C,c)){var d=c.getSelection(),e=d.C,f=d.Ye,h=AH(a.D,e).Gc(),k=A4d(a.C,c);c=y4d(a.C,c);var l=new eM(h,IA(d.Hd),(k?"'":"")+c.substring(0,f.start)+b.C+c.substring(f.end));IF(l,v(function(a){if(a){a=this.C;for(var c=b.C,e=0;e<a.L.length;e++){var f=a.L[e].getSelection();if(Fd(f.Hd,d.Hd)&&f.C==d.C&&f.Ye.start>d.Ye.end){var h=d.Ye.getLength()-c.length;f.Ye.start-=h;f.Ye.end-=h}}}},a));ST(a.D,new YA(e,"",IA(d.Hd)),v(function(){this.F.C(l)},a))}}
function $3d(a,b){b&&ST(a.D,new YA(b.C,"",IA(b.Hd)))};function G4d(a){this.D=new BEc(a)}G4d.prototype.C=function(a){var b=new ty,c=new Sw;W(c,2,a.Hd.y);Tw(c,a.Hd.y+1);c.Ar(a.Hd.x);c.Yx(a.Hd.x+1);W(c,1,""+a.C);qw(b,2,c);c=new sy;W(c,1,""+a.C);W(c,2,a.Hd.y);W(c,3,a.Hd.x);W(b,1,c);return this.D.C(new gB(b))};function H4d(a,b,c,d,e,f,h,k){var l=this;zW.call(this,"docs-spellcheckslidingdialog-id",c);YDc(this,v(this.Psa,this));this.Ha=a;this.Oa=new l4d;this.Ba=new P3d;this.va=new n4d(a);this.H=new $5(a,e,S5.getInstance(),this.Ba,this.va);this.Ma=new F4d(a,b,this.H,this.va);b=Ld();e=new Q3d;a=new m4d(c,(new Wk).build(),new G4d(a),new y3d("trigger-text",!1),this.H,k,e,b);this.qa(a);this.V=a.C;this.D=new U3d(a,this.Ba,this.H,this.Ma,d,this.Oa);this.F=b.xa("DIV",{style:"margin-top: 10px"});this.J=sR("Search the rest of the sheet",
b);this.J.render(this.F);this.getHandler().R(this.J,"action",this.LUb);this.L=sR("Search all sheets",b);this.L.render(this.F);this.getHandler().R(this.L,"action",v(this.Psa,this,"WORKBOOK"));ls(h,S5.getInstance(),"docs-user_dictionary");K.JU.subscribe("action",this.D.hqb,this.D);K.KU.subscribe("action",this.D.mvb,this.D);K.UU.subscribe("action",this.D.$zb,this.D);K.FN.subscribe("action",this.D.Iab,this.D);K.EN.subscribe("action",this.D.Bob,this.D);K.Z2.subscribe("action",v(this.D.YKa,this.D,!1));
K.a3.subscribe("action",v(this.D.YKa,this.D,!0));this.Ka=N3d(f,function(){l.V.setVisible(!1)})}x(H4d,zW);p=H4d.prototype;p.mQ=g("V");p.Hu=function(){H4d.ea.Hu.call(this);this.getHandler().R(this.C,"close",this.p1b).R(this.Ha,"Sa",this.q1b)};p.p1b=function(){this.KB()};p.q1b=function(){this.C.jr();this.KB()};
p.Psa=function(a,b){var c=b||null,d;a||((b=this.Ha.C)?0==b.getSheetType()?(c=b.Gc().Lc(),1<c.qh()?(a="RANGE",c=new YA(b.Ab(),b.le(),c)):(a="SHEET",c=new YA(b.Ab(),b.le(),null))):a="WORKBOOK":a="WORKBOOK");"WORKBOOK"!=a&&(d=15E3);switch(a){case "RANGE":this.J.setVisible(!0);this.L.setVisible(!0);L(this.F,!0);break;case "SHEET":this.J.setVisible(!1);this.L.setVisible(!0);L(this.F,!0);break;case "WORKBOOK":L(this.F,!1)}b=this.H;Y3d(b);b.V=a;b.F=c;switch(a){case "WORKBOOK":b.J=new Dd(-1,0);(a=b.H.h6(-1,
0,!1,!0))?b.D=""+a.Ab():(b.D=null,b.O=!0);break;case "SHEET":b.J=new Dd(-1,0);b.D=""+c.ld;break;case "RANGE":b.J=new Dd(c.rect.left-1,c.rect.top),b.D=""+c.ld}a=this.V;a.Hb=this.F;a.Ac=d?d:5E3;d=this.D;K.Qda.Nc(!0);d.Ja.R(d.F,"docs-text-spellcheckdialogcontroller-closed",d.eZ);d.F.xD(v(d.bNb,d))};p.r1b=function(a){this.Ka(a)};p.LUb=function(){var a=this.H.F;this.Psa("SHEET",new YA(a.ld,a.Qg,null))};function I4d(){A.call(this)}x(I4d,yB);I4d.prototype.C=function(a,b,c,d,e,f,h,k){return new H4d(a,b,c,d,e,f,h,k)};EB("spellcheck",I4d);
